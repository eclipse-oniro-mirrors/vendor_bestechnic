From 67a7a4abaa6b52d87214d46c82c9c40ee8ca570e Mon Sep 17 00:00:00 2001
From: yangjian <jianyang@bestechnic.com>
Date: Sat, 25 Dec 2021 10:46:29 +0800
Subject: [PATCH] test/xts/acts

Signed-off-by: yangjian <jianyang@bestechnic.com>
Change-Id: I9a82d0c15630684b11d75608f379e49982800428
---
 hiviewdfx_lite/hilog_hal/src/dfx_hilog.c        | 2 +-
 utils_lite/kv_store_hal/BUILD.gn                | 6 ++++++
 utils_lite/kv_store_hal/src/kvstore_func_test.c | 5 +++++
 3 files changed, 12 insertions(+), 1 deletion(-)

diff --git a/hiviewdfx_lite/hilog_hal/src/dfx_hilog.c b/hiviewdfx_lite/hilog_hal/src/dfx_hilog.c
index d5925375..0d0e3c4d 100755
--- a/hiviewdfx_lite/hilog_hal/src/dfx_hilog.c
+++ b/hiviewdfx_lite/hilog_hal/src/dfx_hilog.c
@@ -13,7 +13,7 @@
  * limitations under the License.
  */
 
-
+#include <stdbool.h>
 #include <hiview_util.h>
 #include <securec.h>
 #include <hiview_config.h>
diff --git a/utils_lite/kv_store_hal/BUILD.gn b/utils_lite/kv_store_hal/BUILD.gn
index e2f63672..0dbaaf55 100755
--- a/utils_lite/kv_store_hal/BUILD.gn
+++ b/utils_lite/kv_store_hal/BUILD.gn
@@ -13,6 +13,10 @@
 
 import("//test/xts/tools/lite/build/suite_lite.gni")
 
+declare_args() {
+  config_ohos_xts_acts_utils_lite_kv_store_data_path = ""
+}
+
 hctest_suite("ActsKvStoreTest") {
   suite_name = "acts"
   sources = [ "src/kvstore_func_test.c" ]
@@ -23,4 +27,6 @@ hctest_suite("ActsKvStoreTest") {
     "//base/iot_hardware/peripheral/interfaces/kits",
   ]
   cflags = [ "-Wno-error" ]
+  defines =
+      [ "DATA_PATH=\"${config_ohos_xts_acts_utils_lite_kv_store_data_path}\"" ]
 }
diff --git a/utils_lite/kv_store_hal/src/kvstore_func_test.c b/utils_lite/kv_store_hal/src/kvstore_func_test.c
index 8357e49d..ddc12040 100755
--- a/utils_lite/kv_store_hal/src/kvstore_func_test.c
+++ b/utils_lite/kv_store_hal/src/kvstore_func_test.c
@@ -27,6 +27,10 @@
 #define MAX_CACHE_NUM_TEST    10
 #define INVALID_KEY_NUM    128
 
+#ifndef DATA_PATH
+#define DATA_PATH "/data"
+#endif
+
 /**
  * @tc.desc      : register a test suite, this suite is used to test basic flow and interface dependency
  * @param        : subsystem name is utils
@@ -41,6 +45,7 @@ LITE_TEST_SUIT(utils, kvStore, KvStoreFuncTestSuite);
  */
 static BOOL KvStoreFuncTestSuiteSetUp(void)
 {
+    UtilsSetEnv(DATA_PATH);
     return TRUE;
 }
 
-- 
2.17.1

