From d2fb9dfa06f94ea2b31e79b36719d3a3eceda3a4 Mon Sep 17 00:00:00 2001
From: yangjian <jianyang@bestechnic.com>
Date: Sat, 13 Nov 2021 22:31:08 +0800
Subject: [PATCH] feat add platform drivers options

Signed-off-by: yangjian <jianyang@bestechnic.com>
Change-Id: I44f99edbdded821db0218dede8f69496d9aae0e0
---
 khdf/liteos_m/BUILD.gn                    | 4 ++--
 khdf/liteos_m/core/BUILD.gn               | 2 ++
 khdf/liteos_m/network/BUILD.gn            | 2 +-
 khdf/liteos_m/osal/BUILD.gn               | 1 +
 khdf/liteos_m/platform/BUILD.gn           | 1 +
 khdf/liteos_m/test/sample_driver/BUILD.gn | 1 +
 6 files changed, 8 insertions(+), 3 deletions(-)
 mode change 100644 => 100755 khdf/liteos_m/BUILD.gn
 mode change 100644 => 100755 khdf/liteos_m/platform/BUILD.gn

diff --git a/khdf/liteos_m/BUILD.gn b/khdf/liteos_m/BUILD.gn
old mode 100644
new mode 100755
index e59b191..1540e87
--- a/khdf/liteos_m/BUILD.gn
+++ b/khdf/liteos_m/BUILD.gn
@@ -34,10 +34,10 @@ module_switch = defined(LOSCFG_DRIVERS_HDF)
 hdf_driver("hdf_lite") {
   deps = [
     "core",
-    "network",
+    # "network",
     "osal",
     "platform",
-    "test",
+    # "test",
   ]
 }
 
diff --git a/khdf/liteos_m/core/BUILD.gn b/khdf/liteos_m/core/BUILD.gn
index f2fad23..645e200 100644
--- a/khdf/liteos_m/core/BUILD.gn
+++ b/khdf/liteos_m/core/BUILD.gn
@@ -29,6 +29,8 @@
 
 import("//drivers/adapter/khdf/liteos_m/hdf.gni")
 
+module_switch = defined(LOSCFG_DRIVERS_HDF)
+
 hdf_driver("hdf_core") {
   sources = [
     "$HDF_FRAMEWORKS_PATH/core/common/src/devlite_object_config.c",
diff --git a/khdf/liteos_m/network/BUILD.gn b/khdf/liteos_m/network/BUILD.gn
index b6ab11b..ff93c8e 100644
--- a/khdf/liteos_m/network/BUILD.gn
+++ b/khdf/liteos_m/network/BUILD.gn
@@ -29,7 +29,7 @@
 
 import("//drivers/adapter/khdf/liteos_m/hdf.gni")
 
-module_switch = defined(LOSCFG_NET_LWIP_SACK)
+module_switch = defined(LOSCFG_NET_LWIP_SACK) && defined(LOSCFG_DRIVERS_HDF)
 hdf_driver("hdf_network") {
   sources = [
     "$HDF_FRAMEWORKS_PATH/model/network/common/netdevice/net_device.c",
diff --git a/khdf/liteos_m/osal/BUILD.gn b/khdf/liteos_m/osal/BUILD.gn
index 9dd42a6..da27ca1 100644
--- a/khdf/liteos_m/osal/BUILD.gn
+++ b/khdf/liteos_m/osal/BUILD.gn
@@ -29,6 +29,7 @@
 
 import("//drivers/adapter/khdf/liteos_m/hdf.gni")
 
+module_switch = defined(LOSCFG_DRIVERS_HDF)
 hdf_driver("hdf_osal_lite") {
   sources = [
     "src/osal_mem.c",
diff --git a/khdf/liteos_m/platform/BUILD.gn b/khdf/liteos_m/platform/BUILD.gn
old mode 100644
new mode 100755
index 681a334..7ca1d5c
--- a/khdf/liteos_m/platform/BUILD.gn
+++ b/khdf/liteos_m/platform/BUILD.gn
@@ -29,6 +29,7 @@
 
 import("//drivers/adapter/khdf/liteos_m/hdf.gni")
 
+module_switch = defined(LOSCFG_DRIVERS_HDF)
 hdf_driver("hdf_platform_lite") {
   sources = [
     "$HDF_FRAMEWORKS_PATH/support/platform/src/gpio/gpio_core.c",
diff --git a/khdf/liteos_m/test/sample_driver/BUILD.gn b/khdf/liteos_m/test/sample_driver/BUILD.gn
index 2c43726..9653587 100644
--- a/khdf/liteos_m/test/sample_driver/BUILD.gn
+++ b/khdf/liteos_m/test/sample_driver/BUILD.gn
@@ -29,6 +29,7 @@
 
 import("//drivers/adapter/khdf/liteos_m/hdf.gni")
 
+module_switch = defined(LOSCFG_DRIVERS_HDF)
 hdf_driver("sample_driver") {
   sources = [ "src/sample_driver.c" ]
   include_dirs = [ "include" ]
-- 
2.17.1

