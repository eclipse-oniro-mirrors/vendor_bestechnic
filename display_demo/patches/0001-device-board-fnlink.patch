From 0a8bce06a1e00b240e1f9c0211254f402a6ef196 Mon Sep 17 00:00:00 2001
From: SimonLi <likailong@huawei.com>
Date: Thu, 25 Nov 2021 17:02:26 +0800
Subject: [PATCH] device board fnlink

Change-Id: Id6c95715d6dc5405d6184d95ee2e9d88892f2024
---
 fgv200zrxx/liteos_m/config.gni | 97 ++++++++++++++++++----------------
 1 file changed, 51 insertions(+), 46 deletions(-)

diff --git a/fgv200zrxx/liteos_m/config.gni b/fgv200zrxx/liteos_m/config.gni
index e107f5f..887bddf 100644
--- a/fgv200zrxx/liteos_m/config.gni
+++ b/fgv200zrxx/liteos_m/config.gni
@@ -71,16 +71,16 @@ board_cflags = [
 
 board_cxx_flags = board_cflags
 board_ld_flags = [
-  "-mcpu=cortex-m33",
-  "-mfpu=fpv5-sp-d16",
-  "-mfloat-abi=hard",
-  "-fdata-sections",
-  "-mthumb",
-  "-mthumb-interwork",
-  "-lkernel",
-  "-lc",
-  "-lm",
-  "-lstdc++",
+#"-mcpu=cortex-m33",
+# "-mfpu=fpv5-sp-d16",
+#  "-mfloat-abi=hard",
+#  "-fdata-sections",
+#  "-mthumb",
+#  "-mthumb-interwork",
+#  "-lkernel",
+#  "-lc",
+#  "-lm",
+#  "-lstdc++",
   "-L${ohos_root_path}out/${board_name}/${product_name}/libs",
 ]
 
@@ -93,42 +93,47 @@ foreach(fs, fs_list) {
 }
 
 if (wrap_fs_api == "true") {
-  board_ld_flags += [
-    "-Wl,--wrap=mount",
-    "-Wl,--wrap=umount",
-    "-Wl,--wrap=umount2",
-    "-Wl,--wrap=open",
-    "-Wl,--wrap=close",
-    "-Wl,--wrap=read",
-    "-Wl,--wrap=write",
-    "-Wl,--wrap=lseek",
-    "-Wl,--wrap=unlink",
-    "-Wl,--wrap=fstat",
-    "-Wl,--wrap=stat",
-    "-Wl,--wrap=fsync",
-    "-Wl,--wrap=mkdir",
-    "-Wl,--wrap=opendir",
-    "-Wl,--wrap=readdir",
-    "-Wl,--wrap=closedir",
-    "-Wl,--wrap=rmdir",
-    "-Wl,--wrap=rename",
-    "-Wl,--wrap=statfs",
-    "-Wl,--wrap=ftruncate",
-
-    "-Wl,--wrap=fopen",
-    "-Wl,--wrap=fclose",
-    "-Wl,--wrap=fflush",
-    "-Wl,--wrap=fread",
-    "-Wl,--wrap=fwrite",
-    "-Wl,--wrap=fseek",
-    "-Wl,--wrap=ftell",
-    "-Wl,--wrap=fgets",
-    "-Wl,--wrap=fputs",
-    "-Wl,--wrap=feof",
-    "-Wl,--wrap=fileno",
-    "-Wl,--wrap=clearerr",
-    "-Wl,--wrap=strdup",
-  ]
+   board_ld_flags += [
+     "-Wl,--wrap=_malloc_r",
+     "-Wl,--wrap=_realloc_r",
+     "-Wl,--wrap=_reallocf_r",
+     "-Wl,--wrap=_free_r",
+     "-Wl,--wrap=_memalign_r",
+     "-Wl,--wrap=_malloc_usable_size_r",
+     ]
+#     "-Wl,--wrap=umount2",
+#     "-Wl,--wrap=open",
+#     "-Wl,--wrap=close",
+#     "-Wl,--wrap=read",
+#     "-Wl,--wrap=write",
+#     "-Wl,--wrap=lseek",
+#     "-Wl,--wrap=unlink",
+#     "-Wl,--wrap=fstat",
+#     "-Wl,--wrap=stat",
+#     "-Wl,--wrap=fsync",
+#     "-Wl,--wrap=mkdir",
+#     "-Wl,--wrap=opendir",
+#     "-Wl,--wrap=readdir",
+#     "-Wl,--wrap=closedir",
+#     "-Wl,--wrap=rmdir",
+#     "-Wl,--wrap=rename",
+#     "-Wl,--wrap=statfs",
+#     "-Wl,--wrap=ftruncate",
+# 
+#     "-Wl,--wrap=fopen",
+#     "-Wl,--wrap=fclose",
+#     "-Wl,--wrap=fflush",
+#     "-Wl,--wrap=fread",
+#     "-Wl,--wrap=fwrite",
+#     "-Wl,--wrap=fseek",
+#     "-Wl,--wrap=ftell",
+#     "-Wl,--wrap=fgets",
+#     "-Wl,--wrap=fputs",
+#     "-Wl,--wrap=feof",
+#     "-Wl,--wrap=fileno",
+#     "-Wl,--wrap=clearerr",
+#     "-Wl,--wrap=strdup",
+#   ]
 }
 
 # Board related headfiles search path.
-- 
2.17.1

