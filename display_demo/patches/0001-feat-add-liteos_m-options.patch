From 3da5be7fe2b45c0460c46154d95428c0e740b818 Mon Sep 17 00:00:00 2001
From: SimonLi <likailong@huawei.com>
Date: Tue, 19 Oct 2021 15:55:30 +0800
Subject: [PATCH] =?UTF-8?q?feat(patch):=20=E5=90=88=E5=B9=B6=E7=BB=84?=
 =?UTF-8?q?=E4=BB=B6=E9=85=8D=E7=BD=AEpatch=E5=92=8Cmultimedia=E7=9A=84pat?=
 =?UTF-8?q?ch?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: SimonLi <likailong@huawei.com>
Change-Id: Ie4041299b39d29c9f46b27b512e9ed7decbf21fa
---
 components/aafwk.json                  |  1 +
 components/ace.json                    | 19 +++++++++----------
 components/appexecfwk.json             |  1 +
 components/global.json                 | 10 ++++------
 components/graphic.json                | 12 ++++++------
 components/utils.json                  |  3 +++
 components/vendor.json                 |  6 ++++++
 config/subsystem/multimedia/config.gni | 22 ++++++++++++++++++++++
 8 files changed, 52 insertions(+), 22 deletions(-)
 create mode 100755 config/subsystem/multimedia/config.gni

diff --git a/components/aafwk.json b/components/aafwk.json
index e71ad88..8ae543f 100755
--- a/components/aafwk.json
+++ b/components/aafwk.json
@@ -20,6 +20,7 @@
       ],
       "adapted_kernel": [
         "liteos_a",
+        "liteos_m",
         "linux"
       ],
       "features": [
diff --git a/components/ace.json b/components/ace.json
index 8103970..e20e33e 100755
--- a/components/ace.json
+++ b/components/ace.json
@@ -8,13 +8,12 @@
         "foundation/ace/ace_engine_lite"
       ],
       "targets": [
-        "//foundation/ace/ace_engine_lite/frameworks:jsfwk",
-        "//foundation/ace/ace_engine_lite/test:unittest"
+        "//foundation/ace/ace_engine_lite/frameworks:jsfwk"
       ],
       "rom": "521KB",
       "ram": "~82KB",
-      "output": [ "libace_lite.so" ],
-      "adapted_kernel": [ "liteos_a", "linux"],
+      "output": [ "libace_lite.a" ],
+      "adapted_kernel": [ "liteos_a", "liteos_m", "linux"],
       "features": [],
       "deps": {
         "third_party": [
@@ -57,8 +56,8 @@
       ],
       "rom": "9KB",
       "ram": "~2KB",
-      "output": [ "libace_common.so" ],
-      "adapted_kernel": [ "liteos_a", "linux"],
+      "output": [ "libace_common.a" ],
+      "adapted_kernel": [ "liteos_a", "liteos_m", "linux"],
       "features": [],
       "deps": {
         "third_party": [
@@ -83,8 +82,8 @@
       ],
       "rom": "32KB",
       "ram": "~5KB",
-      "output": [ "libace_native_engine.so" ],
-      "adapted_kernel": [ "liteos_a", "linux"],
+      "output": [ "libace_native_engine.a" ],
+      "adapted_kernel": [ "liteos_a", "liteos_m", "linux"],
       "features": [],
       "deps": {
         "third_party": [
@@ -110,8 +109,8 @@
       ],
       "rom": "12KB",
       "ram": "~2KB",
-      "output": [ "libace_module_manager.so" ],
-      "adapted_kernel": [ "liteos_a", "linux"],
+      "output": [ "libace_module_manager.a" ],
+      "adapted_kernel": [ "liteos_a", "liteos_m", "linux"],
       "features": [],
       "deps": {
         "third_party": [
diff --git a/components/appexecfwk.json b/components/appexecfwk.json
index 4253651..79c0ab1 100755
--- a/components/appexecfwk.json
+++ b/components/appexecfwk.json
@@ -21,6 +21,7 @@
       ],
       "adapted_kernel": [
         "liteos_a",
+        "liteos_m",
         "linux"
       ],
       "features": [],
diff --git a/components/global.json b/components/global.json
index 26ad50d..721857a 100644
--- a/components/global.json
+++ b/components/global.json
@@ -8,13 +8,12 @@
         "base/global/resmgr_lite"
       ],
       "targets": [
-        "//base/global/resmgr_lite/frameworks/resmgr_lite:global_resmgr",
-        "//base/global/resmgr_lite/frameworks/resmgr_lite/test:unittest"
+        "//base/global/resmgr_lite/frameworks/resmgr_lite:global_resmgr"
       ],
       "rom": "21KB",
       "ram": "~48KB",
       "output": [ "global_resmgr.so" ],
-      "adapted_kernel": [ "liteos_a" ],
+      "adapted_kernel": [ "liteos_a", "liteos_m" ],
       "features": [],
       "deps": {
         "third_party": [
@@ -33,13 +32,12 @@
         "base/global/i18n_lite"
       ],
       "targets": [
-        "//base/global/i18n_lite/frameworks/i18n:global_i18n",
-        "//base/global/i18n_lite/frameworks/i18n/test:I18nTest"
+        "//base/global/i18n_lite/frameworks/i18n:global_i18n"
       ],
       "rom": "2.5MB",
       "ram": "~112KB",
       "output": [ "global_i18n.so" ],
-      "adapted_kernel": [ "liteos_a" ],
+      "adapted_kernel": [ "liteos_a", "liteos_m" ],
       "features": [],
       "deps": {
         "third_party": [
diff --git a/components/graphic.json b/components/graphic.json
index 135ea4d..f313782 100644
--- a/components/graphic.json
+++ b/components/graphic.json
@@ -6,14 +6,14 @@
       "optional": "true",
       "dirs": ["foundation/graphic/utils"],
       "targets": [
-        "//foundation/graphic/utils:lite_graphic_utils",
-        "//foundation/graphic/utils/test:lite_graphic_utils_test"
+        "//foundation/graphic/utils:lite_graphic_utils"
       ],
       "rom": "",
       "ram": "",
-      "output": ["libgraphic_utils.so"],
+      "output": ["libgraphic_utils.a"],
       "adapted_kernel": [
         "liteos_a",
+        "liteos_m",
         "linux"
       ],
       "features": [],
@@ -117,14 +117,14 @@
       "optional": "true",
       "dirs": ["foundation/graphic/ui"],
       "targets": [
-        "//foundation/graphic/ui:lite_ui",
-        "//foundation/graphic/ui/test/unittest:lite_graphic_ui_test"
+        "//foundation/graphic/ui:lite_ui"
       ],
       "rom": "900KB",
       "ram": "~90KB",
-      "output": ["libui.so"],
+      "output": ["libui.a"],
       "adapted_kernel": [
         "liteos_a",
+        "liteos_m",
         "linux"
       ],
       "features": [],
diff --git a/components/utils.json b/components/utils.json
index 19cdb8b..972d477 100755
--- a/components/utils.json
+++ b/components/utils.json
@@ -125,6 +125,7 @@
       "output": [],
       "adapted_kernel": [
         "liteos_a",
+        "liteos_m",
         "linux"
       ],
       "features": [],
@@ -152,6 +153,7 @@
       "output": [],
       "adapted_kernel": [
         "liteos_a",
+        "liteos_m",
         "linux"
       ],
       "features": [],
@@ -187,6 +189,7 @@
       "output": [],
       "adapted_kernel": [
         "liteos_a",
+        "liteos_m",
         "linux"
       ],
       "features": [],
diff --git a/components/vendor.json b/components/vendor.json
index 4e5c4e9..d012f85 100755
--- a/components/vendor.json
+++ b/components/vendor.json
@@ -277,6 +277,12 @@
           "utils_base"
         ]
       }
+    },
+    {
+      "component": "custom",
+      "features": [],
+      "adapted_kernel": [ "liteos_m", "liteos_a", "linux" ],
+      "targets": []
     }
   ]
 }
diff --git a/config/subsystem/multimedia/config.gni b/config/subsystem/multimedia/config.gni
new file mode 100755
index 0000000..8825281
--- /dev/null
+++ b/config/subsystem/multimedia/config.gni
@@ -0,0 +1,22 @@
+#
+# Copyright (c) 2020 Huawei Device Co., Ltd.
+# Licensed under the Apache License, Version 2.0 (the "License");
+# you may not use this file except in compliance with the License.
+# You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+
+declare_args() {
+  # build histreamer plugin feature ability
+  enable_histreamer_plugin_ffmpeg_adapter = true
+  enable_histreamer_plugin_hdi_adapter = true
+  enable_histreamer_plugin_file_source = true
+  enable_histreamer_plugin_stream_source = true
+}
-- 
2.17.1

