From 1719ea05f9e2734e7450bf4ec0e79fc612c71023 Mon Sep 17 00:00:00 2001
From: leihuang <leihuang@bestechnic.com>
Date: Sun, 19 Sep 2021 14:25:37 +0800
Subject: [PATCH] feat: build libglobal_resmgr.a for liteos_m

Signed-off-by: leihuang <leihuang@bestechnic.com>
Change-Id: Id3f3891622ec396332d26b4e0179c36813fbbc7f
---
 frameworks/resmgr_lite/BUILD.gn | 29 +++++++++++++++++++----------
 1 file changed, 19 insertions(+), 10 deletions(-)
 mode change 100644 => 100755 frameworks/resmgr_lite/BUILD.gn

diff --git a/frameworks/resmgr_lite/BUILD.gn b/frameworks/resmgr_lite/BUILD.gn
old mode 100644
new mode 100755
index ce3ca97..ef16648
--- a/frameworks/resmgr_lite/BUILD.gn
+++ b/frameworks/resmgr_lite/BUILD.gn
@@ -80,16 +80,25 @@ config("global_resmgr_mingw_config") {
 }
 
 if (defined(ohos_lite)) {
-  shared_library("global_resmgr") {
-    sources = global_sources
-    configs += [ ":global_resmgr_config" ]
-    deps = [ "//third_party/bounds_checking_function:libsec_shared" ]
-    if (ohos_kernel_type == "liteos_a") {
-      public_deps = [
-        "//base/global/i18n_lite/frameworks/i18n:global_i18n",
-        "//base/hiviewdfx/hilog_lite/frameworks/featured:hilog_shared",
-        "//build/lite/config/component/zlib:zlib_shared",
-      ]
+  if (ohos_kernel_type == "liteos_m") {
+    static_library("global_resmgr") {
+      sources = global_sources
+      public_configs = [ ":global_resmgr_config" ]
+      deps = [ "//third_party/bounds_checking_function:libsec_static" ]
+      defines = [ "I18N_PRODUCT" ]
+    }
+  } else {
+    shared_library("global_resmgr") {
+      sources = global_sources
+      configs += [ ":global_resmgr_config" ]
+      deps = [ "//third_party/bounds_checking_function:libsec_shared" ]
+      if (ohos_kernel_type == "liteos_a") {
+        public_deps = [
+          "//base/global/i18n_lite/frameworks/i18n:global_i18n",
+          "//base/hiviewdfx/hilog_lite/frameworks/featured:hilog_shared",
+          "//build/lite/config/component/zlib:zlib_shared",
+        ]
+      }
     }
   }
 
-- 
2.17.1

